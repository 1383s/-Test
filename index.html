<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>لوحة اختبارات سو | الاحترافية</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0b0e14; --card: #151921; --accent: #58a6ff; --text: #adbac7; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: var(--text); margin: 0; }
        header { background: var(--card); padding: 20px; text-align: center; border-bottom: 1px solid #30363d; }
        .container { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
        #search { width: 100%; max-width: 500px; padding: 15px; border-radius: 10px; border: 1px solid #30363d; background: #0b0e14; color: #fff; margin: 0 auto 30px auto; display: block; font-family: inherit; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .exam-card { background: var(--card); border: 1px solid #30363d; border-radius: 12px; padding: 20px; cursor: pointer; transition: 0.3s; text-align: right; }
        .exam-card:hover { border-color: var(--accent); transform: translateY(-5px); }
        .id-badge { background: #21262d; color: var(--accent); padding: 2px 8px; border-radius: 5px; font-size: 0.8rem; margin-bottom: 10px; display: inline-block; }
        h3 { margin: 0; color: #fff; font-size: 1.1rem; min-height: 1.5em; }
    </style>
</head>
<body>
    <header><h1>⚡ لوحة اختبارات سو</h1></header>
    <div class="container">
        <input type="text" id="search" placeholder="ابحث بالاسم أو رقم الاختبار...">
        <div class="grid" id="list"></div>
    </div>

    <script>
        const list = document.getElementById('list');
        const searchInput = document.getElementById('search');

        // دالة إنشاء كارت الاختبار
        function createCard(id, title) {
            const card = document.createElement('div');
            card.className = 'exam-card';
            card.setAttribute('data-search', `${id} ${title.toLowerCase()}`);
            card.innerHTML = `
                <div class="id-badge">ID: #${id}</div>
                <h3 id="title-${id}">${title}</h3>
                <small style="color: #6e7681;">اضغط للبدء</small>
            `;
            card.onclick = () => window.location.href = `quiz.html?id=${id}`;
            list.appendChild(card);
        }

        async function loadAllExams() {
            // النطاقات اللي طلبتها: من 1 لـ 41 ومن 400 لـ 701
            const ranges = [
                { start: 1, end: 41 },
                { start: 400, end: 701 }
            ];

            for (const range of ranges) {
                for (let i = range.start; i <= range.end; i++) {
                    // بنعرض الكارت بالرقم مؤقتاً لحد ما الـ fetch يخلص
                    createCard(i, `اختبار رقم ${i}`);
                    
                    // محاولة جلب العنوان الحقيقي
                    fetch(`الاختبارات/exam_${i}.json`)
                        .then(res => res.json())
                        .then(json => {
                            const realTitle = json.data.data.exam.title;
                            const titleElement = document.getElementById(`title-${i}`);
                            if (titleElement) {
                                titleElement.innerText = realTitle;
                                titleElement.parentElement.setAttribute('data-search', `${i} ${realTitle.toLowerCase()}`);
                            }
                        })
                        .catch(() => {
                            // لو فشل بنسيبه زي ما هو "اختبار رقم i"
                            console.log(`ملف ${i} غير متوفر، تم الاكتفاء بالرقم.`);
                        });
                }
            }
        }

        // دالة البحث
        searchInput.oninput = (e) => {
            const term = e.target.value.toLowerCase();
            document.querySelectorAll('.exam-card').forEach(card => {
                const searchData = card.getAttribute('data-search');
                card.style.display = searchData.includes(term) ? 'block' : 'none';
            });
        };

        loadAllExams();
    </script>
</body>
</html>
